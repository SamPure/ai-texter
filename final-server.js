const express=require("express"),cors=require("cors"),fs=require("fs"),path=require("path"),app=express(),FILE=path.join(__dirname,"saved_conversations.json");fs.existsSync(FILE)||fs.writeFileSync(FILE,"[]"),app.use(cors()),app.use(express.json()),app.post("/training",(e,s)=>{console.log("1. Received request");try{console.log("2. Request body:",JSON.stringify(e.body,null,2));const i=JSON.parse(fs.readFileSync(FILE,"utf8"));console.log("3. Current file contents:",i);const t={conversation:e.body.conversation,timestamp:(new Date).toISOString()};i.push(t),fs.writeFileSync(FILE,JSON.stringify(i,null,2)),console.log("4. Saved new conversation");const n=fs.readFileSync(FILE,"utf8");console.log("5. Verified file contents:",n),s.json({success:!0})}catch(i){console.error("Error:",i),s.status(500).json({error:i.message})}}),app.get("/",(e,s)=>s.json({status:"ok"})),app.listen(3001,()=>{console.log("Server running on port 3001"),console.log("Saving conversations to:",FILE)});
